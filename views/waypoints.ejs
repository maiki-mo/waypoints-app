<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Waypoints</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" media="screen" href="/styles.css" />
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" />

</head>
<body>
<div>
  </div>
  <h1 class="title">Waypoints:</h1>
  <div id="homepage">
    <div id="map">
    </div>
    <br />
    <h3>User Information:</h3>
    <div id="ninja">
      <h4>Username: <%= user.username %></h4>
      <h4>Email: <%= user.email %></h4>
    </div>
    <h3>User Routes:</h3>
    <div id="ninja">
      <% arrayHolder = [] %>
      <% user.routes.forEach(route => {%>
      <h4>Waypoint Group:</h4>
      <p><%= route.id %></p>
          <%route.waypoints.forEach( waypoint => { %>
          <p>Name: <%=waypoint.name%></p>
          <p>Lat: <%=waypoint.lat%></p>
          <p>Lng: <%=waypoint.lng%></p>
          <p>Time: <%=waypoint.time%></p>
          <% arrayHolder.push(waypoint.lat) %>
          <% arrayHolder.push(waypoint.lng) %>
          <% }) %>
          <% }) %>
        <%= arrayHolder %>
    </div>
  </div>
  <script>
    function initMap() {
      var directionsService = new google.maps.DirectionsService;
      var directionsDisplay = new google.maps.DirectionsRenderer;
      var map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: <%=arrayHolder[0]%>, lng: <%=arrayHolder[1]%>},
          zoom: 15
        });
      directionsDisplay.setMap(map);

      function directions() {
          calculateAndDisplayRoute(directionsService, directionsDisplay);
        }

      var marker = new google.maps.Marker({
        position: {lat: <%=arrayHolder[0]%>, lng: <%=arrayHolder[1]%>},
        map: map,
        title: 'Starting Point'
      })

      var markerTwo = new google.maps.Marker({
        position: {lat: <%=arrayHolder[2]%>, lng: <%=arrayHolder[3]%>},
        map: map,
        title: 'Ending Point'
      })
    }
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBpsmQEFJ1UAww2q0_sJd9qIV3vEzTneqs&callback=initMap"></script>
</body>
</html>